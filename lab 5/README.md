# cybersecurity

# PWN:

# racecar
https://app.hackthebox.com/challenges/racecar

Для начала скачиваем файл с HTB, чтобы проанализировать его

![alt text](img/5_1.png)

Если его запустить, и победить в гонке, будет следующее сообщение:

![alt text](img/5_2.png)

Создадим файл flag.txt в той же дирректории что и испольняемый файл:

![alt text](img/5_3.png)

Проанализируем исходный код, к примеру, с помощью ghydra

![alt text](img/5_4.png)

![alt text](img/5_5.png)
В методе main() нет ничего интересного, кроме проверки на существование flag.txt
А вот в методе car_menu() есть момента ввода данных и прямого их вывода обратно, что можно использовать.

Добавим в файл flag.txt, к примеру, следующее сообщение:

![alt text](img/5_6.png)

И напишем скрипт на питоне, который доходит до конца гонки и вводит "%p" 
Несколько раз анализируя вывод, я поставил комментарий перед 12 ввродом "%p", места, с которого выводится содержимое файла flag.txt

![alt text](img/5_7.png)

![alt text](img/5_8.png)

Напишем ещё один скрипт, который будет декодировать получаемые сообщения

![alt text](img/5_9.png)

Результат его работы:

![alt text](img/5_10.png)

Теперь можно переписать скрипт для получения флага, чтобы он работал с реальной программой:

![alt text](img/5_11.png)

Получаем следующий ответ

![alt text](img/5_12.png)

И декодируя его, получаем ключ:

![alt text](img/5_13.png)

![alt text](img/5_14.png)

#You know 0xDiablos 
https://app.hackthebox.com/challenges/you-know-0xdiablos

Также начнём со скачивания файла с HTB, и проанализируем его с помощью ghydra
Здесь нам интересны методы vuln() и flag() (метод vuln() вызывается в main())

![alt text](img/d1.png)

![alt text](img/d2.png)

Внутри мметода flag(), чтобы нам выслали интересующий нас флаг, происходит проверка на параметры, значения которых можно увидеть:

![alt text](img/d3.png)

Сам метод vuln() не представляет из себя ничего особенного, он просто возвращает значение на экран.
Так как в этом задании, в отличие от предыдущего нет защиты от перегруза буфера, попробуем воспользоваться этим:
Перегружаем буфер

![alt text](img/d4.png)

И получаем следующие результаты, чтобы перегрузить регистр EIP, необходимо 188 символов, а для перегрузки ESP - 192

![alt text](img/d5.png)

![alt text](img/d6.png)

Напишем скрипт, который перегружает буфер, а в соответствующие регистры посылает адрес метода flag() и необходимые значения
В ответ получаем наш флаг:

![alt text](img/d7.png)
