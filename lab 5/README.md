# cybersecurity

# PWN:

# racecar
https://app.hackthebox.com/challenges/racecar

Для начала скачиваем файл с HTB, чтобы проанализировать его

![alt text](img/5_1.png)

Если его запустить, и победить в гонке, будет следующее сообщение:

![alt text](img/5_2.png)

Создадим файл flag.txt в той же дирректории что и испольняемый файл:

![alt text](img/5_3.png)

Проанализируем исходный код, к примеру, с помощью ghydra

![alt text](img/5_4.png)

![alt text](img/5_5.png)
В методе main() нет ничего интересного, кроме проверки на существование flag.txt
А вот в методе car_menu() есть момента ввода данных и прямого их вывода обратно, что можно использовать.

Добавим в файл flag.txt, к примеру, следующее сообщение:

![alt text](img/5_6.png)

И напишем скрипт на питоне, который доходит до конца гонки и вводит "%p" 
Несколько раз анализируя вывод, я поставил комментарий перед 12 ввродом "%p", места, с которого выводится содержимое файла flag.txt

![alt text](img/5_7.png)

![alt text](img/5_8.png)

Напишем ещё один скрипт, который будет декодировать получаемые сообщения

![alt text](img/5_9.png)

Результат его работы:

![alt text](img/5_10.png)

Теперь можно переписать скрипт для получения флага, чтобы он работал с реальной программой:

![alt text](img/5_11.png)

Получаем следующий ответ

![alt text](img/5_12.png)

И декодируя его, получаем ключ:

![alt text](img/5_13.png)

![alt text](img/5_14.png)
